name: Termux Commands Executor

on:
  workflow_dispatch:
    inputs:
      commands_file:
        description: 'Path to commands file'
        required: false
        default: '.termux-commands'
      execute_type:
        description: 'Execution type'
        required: true
        default: 'script'
        type: choice
        options:
        - script
        - interactive
        - package_install

jobs:
  termux-commands:
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout repository
      uses: actions/checkout@v4

    - name: Create default commands file
      if: github.event.inputs.commands_file == '.termux-commands'
      run: |
        cat > .termux-commands << 'EOF'
        # Termux Commands Script
        pwd
        ls -la
        python3 --version
        pip3 list --format=columns | head -10
        node --version
        npm --version
        git --version
        neofetch --stdout
        echo "Termux simulation completed!"
        EOF

    - name: Execute Termux commands
      run: |
        echo "🏃 Executing Termux commands..."
        echo "================================="
        
        # Set up environment
        export TERMUX_SIMULATION="true"
        export HOME=$GITHUB_WORKSPACE/termux-home
        mkdir -p $HOME
        
        # Execute commands based on type
        case "${{ github.event.inputs.execute_type }}" in
          "script")
            if [ -f "${{ github.event.inputs.commands_file }}" ]; then
              echo "📜 Running script: ${{ github.event.inputs.commands_file }}"
              bash "${{ github.event.inputs.commands_file }}"
            else
              echo "❌ Script file not found: ${{ github.event.inputs.commands_file }}"
            fi
            ;;
          "interactive")
            echo "💬 Interactive mode:"
            echo "Running common Termux commands..."
            echo "$ pwd && ls -la"
            pwd && ls -la
            echo "$ python3 -c \"print('Hello from Python!')\""
            python3 -c "print('Hello from Python!')"
            echo "$ node -e \"console.log('Hello from Node.js!')\""
            node -e "console.log('Hello from Node.js!')"
            ;;
          "package_install")
            echo "📦 Package installation simulation:"
            echo "Installing common Termux packages..."
            sudo apt-get update
            sudo apt-get install -y python3 nodejs git ffmpeg
            pip3 install requests pillow youtube-dl
            ;;
        esac

    - name: Generate command output
      run: |
        echo "📊 COMMAND EXECUTION SUMMARY" > command-summary.txt
        echo "=============================" >> command-summary.txt
        echo "Execution Type: ${{ github.event.inputs.execute_type }}" >> command-summary.txt
        echo "Commands File: ${{ github.event.inputs.commands_file }}" >> command-summary.txt
        echo "Timestamp: $(date)" >> command-summary.txt
        echo "" >> command-summary.txt
        echo "Available Packages:" >> command-summary.txt
        python3 --version 2>/dev/null >> command-summary.txt || echo "Python3: Not available" >> command-summary.txt
        node --version 2>/dev/null >> command-summary.txt || echo "Node.js: Not available" >> command-summary.txt
        git --version 2>/dev/null >> command-summary.txt || echo "Git: Not available" >> command-summary.txt
        
        cat command-summary.txt
